<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Shared Persistent Heap Data Environment Manual: src/saslock.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>src/saslock.h File Reference</h1>
<p>Shared Address Space User Locks. Address based locking for shared address space blocks and utility objects.  
<a href="#_details">More...</a></p>

<p><a href="saslock_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4d08a6f74d96b695afefd03854839b83"></a><!-- doxytag: member="saslock.h::__C__" ref="a4d08a6f74d96b695afefd03854839b83" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ignore this macro behind the curtain <br/></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac8ba6746799005639a7156774b7300c2"></a><!-- doxytag: member="saslock.h::vm_address_t" ref="ac8ba6746799005639a7156774b7300c2" args="" -->
typedef void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#ac8ba6746799005639a7156774b7300c2">vm_address_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generic address to be used as symbolic lock ID. <br/></td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a35f393730e4d328d1ade10dddd4404c9">sas_userlock_request_t</a> { <b>SasUserLock__READ</b>, 
<b>SasUserLock__WRITE</b>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>SAS Lock request types. </p>
<br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__C__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a7220f785a5a2a14df1f733278d311a89">SASLockReset</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reset the SAS Lock tables.  <a href="#a7220f785a5a2a14df1f733278d311a89"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__C__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#aa09df87d48bbf26984c989a98e1a7b9e">SASLockInit</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the SAS Lock tables.  <a href="#aa09df87d48bbf26984c989a98e1a7b9e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__C__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a554c10c18c84297ce7a2ef91b1c4af42">SASLock</a> (<a class="el" href="saslock_8h.html#ac8ba6746799005639a7156774b7300c2">vm_address_t</a> addr, <a class="el" href="saslock_8h.html#a35f393730e4d328d1ade10dddd4404c9">sas_userlock_request_t</a> lockT)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Lock a SAS Address.  <a href="#a554c10c18c84297ce7a2ef91b1c4af42"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__C__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a33b8c7a9a5f493c42c8d4619e24a46d2">SASUnlock</a> (<a class="el" href="saslock_8h.html#ac8ba6746799005639a7156774b7300c2">vm_address_t</a> addr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">UnLock a SAS Address.  <a href="#a33b8c7a9a5f493c42c8d4619e24a46d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__C__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#ae361afbe3332e1e887e4706bba36c91b">SASLockPrintHighLevelStats</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print High level Lock Statistic.  <a href="#ae361afbe3332e1e887e4706bba36c91b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__C__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#afe5422768d2e94c359ef1ffd094d1d29">SASLockPrintDetailedStats</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print detailed Lock Statistic.  <a href="#afe5422768d2e94c359ef1ffd094d1d29"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__C__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a7cd80a86f3158e914c2172ad2c0ef5e4">SASLockDetach</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Detach the shared memory segment holding the SAS lock tables.  <a href="#a7cd80a86f3158e914c2172ad2c0ef5e4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">__C__ void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a45122c9898046089d5c1f673fda8a792">SASLockRemove</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Remove the shared memory segment holding the SAS lock tables.  <a href="#a45122c9898046089d5c1f673fda8a792"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afa2a9e0ef22fb20ccea8426a03d50c18"></a><!-- doxytag: member="saslock.h::SasLockOwner" ref="afa2a9e0ef22fb20ccea8426a03d50c18" args="" -->
__C__ int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#afa2a9e0ef22fb20ccea8426a03d50c18">SasLockOwner</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Lock Segment Owner TRUE if this process was the first to run and created the lock segment. Other process discover the exixting lock segment and simply attach it. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Shared Address Space User Locks. Address based locking for shared address space blocks and utility objects. </p>
<p>! SAS Locks are not stored within the SAS blocks, which would create recoverability issues at large scale. Instead locks are address symbolic with active locks maintained in hash tables in shared memory. The byte effective address of the data becomes the lock symbol. In SAS storage addresses are context free across all processes sharing a SAS region. This enables locking across all processes sharing a SAS region.</p>
<p>SAS Locks implements shared read locks and exclusive write locks. SAS locks are recursive within a thread.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>In a future implementation the intent is to extend SAS Locks to support Write Intent locks. Intent Locks would allow the holder to gain a shared lock that can be upgraded to exclusive write lock later, if needed. A Intent lock allows current holders of read locks to continue, but prevents new read locks from being granted. New read locks are held (not granted) until the corresponding Intent Lock or upgraded Write Lock is released (unlockd).</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Need a API to return the PIDs associated with held locks. This will be needed to recover from hung or crashed processes.</dd></dl>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a554c10c18c84297ce7a2ef91b1c4af42"></a><!-- doxytag: member="saslock.h::SASLock" ref="a554c10c18c84297ce7a2ef91b1c4af42" args="(vm_address_t addr, sas_userlock_request_t lockT)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__C__ void SASLock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="saslock_8h.html#ac8ba6746799005639a7156774b7300c2">vm_address_t</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="saslock_8h.html#a35f393730e4d328d1ade10dddd4404c9">sas_userlock_request_t</a>&nbsp;</td>
          <td class="paramname"> <em>lockT</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Lock a SAS Address. </p>
<p>Lock an address for shared read or exclusive write access by this thread.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>Data address to be locked. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lockT</em>&nbsp;</td><td>Lock (SasUserLock__READ, SasUserLock__WRITE) type. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7cd80a86f3158e914c2172ad2c0ef5e4"></a><!-- doxytag: member="saslock.h::SASLockDetach" ref="a7cd80a86f3158e914c2172ad2c0ef5e4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__C__ void SASLockDetach </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Detach the shared memory segment holding the SAS lock tables. </p>
<p>Used for cleanup, called from SASCleanup. </p>

</div>
</div>
<a class="anchor" id="aa09df87d48bbf26984c989a98e1a7b9e"></a><!-- doxytag: member="saslock.h::SASLockInit" ref="aa09df87d48bbf26984c989a98e1a7b9e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__C__ void SASLockInit </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize the SAS Lock tables. </p>
<p>Initialize the lock tables when a SAS region is created or a process attaches to the SAS Region after the system is restarted. The first process creates a shared memory segment unique to the region and sets SasLockOwner TRUE. Otherwise the existenting shm segment is attached and SasLockOwner is FALSE. This shm segment will hold the shared lock tables that hold active symbolic locks. </p>

</div>
</div>
<a class="anchor" id="afe5422768d2e94c359ef1ffd094d1d29"></a><!-- doxytag: member="saslock.h::SASLockPrintDetailedStats" ref="afe5422768d2e94c359ef1ffd094d1d29" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__C__ void SASLockPrintDetailedStats </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print detailed Lock Statistic. </p>

</div>
</div>
<a class="anchor" id="ae361afbe3332e1e887e4706bba36c91b"></a><!-- doxytag: member="saslock.h::SASLockPrintHighLevelStats" ref="ae361afbe3332e1e887e4706bba36c91b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__C__ void SASLockPrintHighLevelStats </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print High level Lock Statistic. </p>

</div>
</div>
<a class="anchor" id="a45122c9898046089d5c1f673fda8a792"></a><!-- doxytag: member="saslock.h::SASLockRemove" ref="a45122c9898046089d5c1f673fda8a792" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__C__ void SASLockRemove </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Remove the shared memory segment holding the SAS lock tables. </p>
<p>Used for cleanup, called from SASRemove. </p>

</div>
</div>
<a class="anchor" id="a7220f785a5a2a14df1f733278d311a89"></a><!-- doxytag: member="saslock.h::SASLockReset" ref="a7220f785a5a2a14df1f733278d311a89" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__C__ void SASLockReset </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reset the SAS Lock tables. </p>
<p>Reset the lock tables to the initialized state. Any held locks will be lost without resuming any waiters.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>This API is intended to recover from hung or crashed processes. </dd></dl>

</div>
</div>
<a class="anchor" id="a33b8c7a9a5f493c42c8d4619e24a46d2"></a><!-- doxytag: member="saslock.h::SASUnlock" ref="a33b8c7a9a5f493c42c8d4619e24a46d2" args="(vm_address_t addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__C__ void SASUnlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="saslock_8h.html#ac8ba6746799005639a7156774b7300c2">vm_address_t</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>UnLock a SAS Address. </p>
<p>Unlock a previously locked address held by this thread.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>Data address to be unlocked. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 3 Jun 2014 for Shared Persistent Heap Data Environment Manual by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
