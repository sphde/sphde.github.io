<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Shared Persistent Heap Data Environment Manual: src/saslock.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Shared Persistent Heap Data Environment Manual
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">saslock.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Shared Address Space User Locks. Address based locking for shared address space blocks and utility objects.  
<a href="#details">More...</a></p>

<p><a href="saslock_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4d08a6f74d96b695afefd03854839b83"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4d08a6f74d96b695afefd03854839b83"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a></td></tr>
<tr class="memdesc:a4d08a6f74d96b695afefd03854839b83"><td class="mdescLeft">&#160;</td><td class="mdescRight">ignore this macro behind the curtain <br /></td></tr>
<tr class="separator:a4d08a6f74d96b695afefd03854839b83"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ac8ba6746799005639a7156774b7300c2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac8ba6746799005639a7156774b7300c2"></a>
typedef void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#ac8ba6746799005639a7156774b7300c2">vm_address_t</a></td></tr>
<tr class="memdesc:ac8ba6746799005639a7156774b7300c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic address to be used as symbolic lock ID. <br /></td></tr>
<tr class="separator:ac8ba6746799005639a7156774b7300c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a35f393730e4d328d1ade10dddd4404c9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a35f393730e4d328d1ade10dddd4404c9"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a35f393730e4d328d1ade10dddd4404c9">sas_userlock_request_t</a> { <b>SasUserLock__READ</b>, 
<b>SasUserLock__WRITE</b>
 }</td></tr>
<tr class="memdesc:a35f393730e4d328d1ade10dddd4404c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">SAS Lock request types. <br /></td></tr>
<tr class="separator:a35f393730e4d328d1ade10dddd4404c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7220f785a5a2a14df1f733278d311a89"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a7220f785a5a2a14df1f733278d311a89">SASLockReset</a> (void)</td></tr>
<tr class="memdesc:a7220f785a5a2a14df1f733278d311a89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the SAS Lock tables.  <a href="#a7220f785a5a2a14df1f733278d311a89">More...</a><br /></td></tr>
<tr class="separator:a7220f785a5a2a14df1f733278d311a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa09df87d48bbf26984c989a98e1a7b9e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#aa09df87d48bbf26984c989a98e1a7b9e">SASLockInit</a> (void)</td></tr>
<tr class="memdesc:aa09df87d48bbf26984c989a98e1a7b9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the SAS Lock tables.  <a href="#aa09df87d48bbf26984c989a98e1a7b9e">More...</a><br /></td></tr>
<tr class="separator:aa09df87d48bbf26984c989a98e1a7b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a554c10c18c84297ce7a2ef91b1c4af42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a554c10c18c84297ce7a2ef91b1c4af42">SASLock</a> (<a class="el" href="saslock_8h.html#ac8ba6746799005639a7156774b7300c2">vm_address_t</a> addr, <a class="el" href="saslock_8h.html#a35f393730e4d328d1ade10dddd4404c9">sas_userlock_request_t</a> lockT)</td></tr>
<tr class="memdesc:a554c10c18c84297ce7a2ef91b1c4af42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock a SAS Address.  <a href="#a554c10c18c84297ce7a2ef91b1c4af42">More...</a><br /></td></tr>
<tr class="separator:a554c10c18c84297ce7a2ef91b1c4af42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33b8c7a9a5f493c42c8d4619e24a46d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a33b8c7a9a5f493c42c8d4619e24a46d2">SASUnlock</a> (<a class="el" href="saslock_8h.html#ac8ba6746799005639a7156774b7300c2">vm_address_t</a> addr)</td></tr>
<tr class="memdesc:a33b8c7a9a5f493c42c8d4619e24a46d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">UnLock a SAS Address.  <a href="#a33b8c7a9a5f493c42c8d4619e24a46d2">More...</a><br /></td></tr>
<tr class="separator:a33b8c7a9a5f493c42c8d4619e24a46d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae361afbe3332e1e887e4706bba36c91b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#ae361afbe3332e1e887e4706bba36c91b">SASLockPrintHighLevelStats</a> (void)</td></tr>
<tr class="memdesc:ae361afbe3332e1e887e4706bba36c91b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print High level Lock Statistic.  <a href="#ae361afbe3332e1e887e4706bba36c91b">More...</a><br /></td></tr>
<tr class="separator:ae361afbe3332e1e887e4706bba36c91b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe5422768d2e94c359ef1ffd094d1d29"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#afe5422768d2e94c359ef1ffd094d1d29">SASLockPrintDetailedStats</a> (void)</td></tr>
<tr class="memdesc:afe5422768d2e94c359ef1ffd094d1d29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print detailed Lock Statistic.  <a href="#afe5422768d2e94c359ef1ffd094d1d29">More...</a><br /></td></tr>
<tr class="separator:afe5422768d2e94c359ef1ffd094d1d29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cd80a86f3158e914c2172ad2c0ef5e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a7cd80a86f3158e914c2172ad2c0ef5e4">SASLockDetach</a> (void)</td></tr>
<tr class="memdesc:a7cd80a86f3158e914c2172ad2c0ef5e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detach the shared memory segment holding the SAS lock tables.  <a href="#a7cd80a86f3158e914c2172ad2c0ef5e4">More...</a><br /></td></tr>
<tr class="separator:a7cd80a86f3158e914c2172ad2c0ef5e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45122c9898046089d5c1f673fda8a792"><td class="memItemLeft" align="right" valign="top"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#a45122c9898046089d5c1f673fda8a792">SASLockRemove</a> (void)</td></tr>
<tr class="memdesc:a45122c9898046089d5c1f673fda8a792"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the shared memory segment holding the SAS lock tables.  <a href="#a45122c9898046089d5c1f673fda8a792">More...</a><br /></td></tr>
<tr class="separator:a45122c9898046089d5c1f673fda8a792"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afa2a9e0ef22fb20ccea8426a03d50c18"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afa2a9e0ef22fb20ccea8426a03d50c18"></a>
<a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="saslock_8h.html#afa2a9e0ef22fb20ccea8426a03d50c18">SasLockOwner</a></td></tr>
<tr class="memdesc:afa2a9e0ef22fb20ccea8426a03d50c18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock Segment Owner TRUE if this process was the first to run and created the lock segment. Other process discover the exixting lock segment and simply attach it. <br /></td></tr>
<tr class="separator:afa2a9e0ef22fb20ccea8426a03d50c18"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Shared Address Space User Locks. Address based locking for shared address space blocks and utility objects. </p>
<p>! SAS Locks are not stored within the SAS blocks, which would create recoverability issues at large scale. Instead locks are address symbolic with active locks maintained in hash tables in shared memory. The byte effective address of the data becomes the lock symbol. In SAS storage addresses are context free across all processes sharing a SAS region. This enables locking across all processes sharing a SAS region.</p>
<p>SAS Locks implements shared read locks and exclusive write locks. SAS locks are recursive within a thread.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>In a future implementation the intent is to extend SAS Locks to support Write Intent locks. Intent Locks would allow the holder to gain a shared lock that can be upgraded to exclusive write lock later, if needed. A Intent lock allows current holders of read locks to continue, but prevents new read locks from being granted. New read locks are held (not granted) until the corresponding Intent Lock or upgraded Write Lock is released (unlockd).</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Need a API to return the PIDs associated with held locks. This will be needed to recover from hung or crashed processes.</dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a554c10c18c84297ce7a2ef91b1c4af42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void SASLock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="saslock_8h.html#ac8ba6746799005639a7156774b7300c2">vm_address_t</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="saslock_8h.html#a35f393730e4d328d1ade10dddd4404c9">sas_userlock_request_t</a>&#160;</td>
          <td class="paramname"><em>lockT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lock a SAS Address. </p>
<p>Lock an address for shared read or exclusive write access by this thread.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>Data address to be locked. </td></tr>
    <tr><td class="paramname">lockT</td><td>Lock (SasUserLock__READ, SasUserLock__WRITE) type. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7cd80a86f3158e914c2172ad2c0ef5e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void SASLockDetach </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detach the shared memory segment holding the SAS lock tables. </p>
<p>Used for cleanup, called from SASCleanup. </p>

</div>
</div>
<a class="anchor" id="aa09df87d48bbf26984c989a98e1a7b9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void SASLockInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the SAS Lock tables. </p>
<p>Initialize the lock tables when a SAS region is created or a process attaches to the SAS Region after the system is restarted. The first process creates a shared memory segment unique to the region and sets SasLockOwner TRUE. Otherwise the existenting shm segment is attached and SasLockOwner is FALSE. This shm segment will hold the shared lock tables that hold active symbolic locks. </p>

</div>
</div>
<a class="anchor" id="afe5422768d2e94c359ef1ffd094d1d29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void SASLockPrintDetailedStats </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print detailed Lock Statistic. </p>

</div>
</div>
<a class="anchor" id="ae361afbe3332e1e887e4706bba36c91b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void SASLockPrintHighLevelStats </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print High level Lock Statistic. </p>

</div>
</div>
<a class="anchor" id="a45122c9898046089d5c1f673fda8a792"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void SASLockRemove </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the shared memory segment holding the SAS lock tables. </p>
<p>Used for cleanup, called from SASRemove. </p>

</div>
</div>
<a class="anchor" id="a7220f785a5a2a14df1f733278d311a89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void SASLockReset </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the SAS Lock tables. </p>
<p>Reset the lock tables to the initialized state. Any held locks will be lost without resuming any waiters.</p>
<dl class="section note"><dt>Note</dt><dd>This API is intended to recover from hung or crashed processes. </dd></dl>

</div>
</div>
<a class="anchor" id="a33b8c7a9a5f493c42c8d4619e24a46d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="sphtimer_8h.html#a4d08a6f74d96b695afefd03854839b83">__C__</a> void SASUnlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="saslock_8h.html#ac8ba6746799005639a7156774b7300c2">vm_address_t</a>&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UnLock a SAS Address. </p>
<p>Unlock a previously locked address held by this thread.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>Data address to be unlocked. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jun 23 2016 08:36:09 for Shared Persistent Heap Data Environment Manual by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
